<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Arkada≈ülar</title>
<!-- T√ºrk√ße karakter destekleyen font -->
<link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700&display=swap" rel="stylesheet">
<style>
    * { box-sizing: border-box; }
    html, body {
        margin:0; padding:0;
        width:100%; height:100%;
        overflow:hidden;
        font-family:'Baloo 2', cursive; /* Yeni font */
    }
    body {
        background: url("bg3.png") no-repeat center center;
        background-size: cover;
        display:flex;
        flex-direction:column;
        align-items:center;
        justify-content:center;
        color:white;
        position:relative;
    }
    h1 {
        margin:10px 0;
        font-size:32px;
        text-shadow:2px 2px 0px #000;
        text-align:center;
    }
    .geri-btn {
        position:absolute;
        top:15px;
        left:15px;
        background:linear-gradient(180deg,#ff1744,#b71c1c);
        color:white;
        border:none;
        border-radius:12px;
        padding:8px 16px;
        font-size:16px;
        cursor:pointer;
        box-shadow:0 3px 6px rgba(0,0,0,0.5);
    }
    .geri-btn:hover { transform:scale(1.05); }
    .container {
        display:flex;
        flex-direction:row;
        justify-content:space-between;
        align-items:flex-start;
        width:95%;
        height:75%;
        gap:15px;
    }
    .card {
        flex:1;
        background:rgba(0,0,0,0.6);
        padding:15px;
        border-radius:20px;
        box-shadow:0 6px 12px rgba(0,0,0,0.5);
        color:white;
        text-align:center;
        overflow-y:auto;
    }
    .card::-webkit-scrollbar { display:none; }
    input {
        font-family:'Baloo 2', cursive;
        padding:12px;
        border:none;
        border-radius:12px;
        margin:10px 0;
        width:100%;
        font-size:16px;
        text-align:center;
    }
    button {
        font-family:'Baloo 2', cursive;
        padding:12px 18px;
        border:none;
        border-radius:15px;
        margin:5px 0;
        font-size:16px;
        cursor:pointer;
        color:white;
        background:linear-gradient(180deg, #ffb300, #ff6f00);
        box-shadow:0 4px 6px rgba(0,0,0,0.4);
        transition:0.2s;
    }
    button:hover { transform:scale(1.05); }
    .friend, .istek {
        display:flex;
        justify-content:space-between;
        align-items:center;
        padding:10px;
        border-radius:12px;
        margin-top:8px;
        font-size:16px;
        text-shadow:1px 1px 0px #000;
    }
    .friend {
        background:rgba(33,150,243,0.8);
    }
    .istek {
        background:rgba(255,193,7,0.85);
        flex-direction:column;
        align-items:flex-start;
    }
    .istek button {
        margin-top:6px;
        width:48%;
    }
    .istek-btns {
        display:flex;
        width:100%;
        justify-content:space-between;
    }
    /* Online davet kutularƒ± */
    #onlineInvites {
        position: fixed;
        top: 100px;
        right: 20px;
        width: 250px;
        max-height: 400px;
        overflow-y: auto;
        z-index: 100;
    }
    .inviteBox {
        background: rgba(255,193,7,0.85);
        padding: 10px;
        margin-bottom: 8px;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        align-items: flex-start;
    }
    .inviteBox button {
        margin-top: 5px;
        width: 48%;
    }
    @media (orientation:portrait) {
        body::before {
            content:"L√ºtfen telefonu yatay √ßeviriniz üì±‚û°Ô∏è";
            position:absolute;
            top:50%; left:50%;
            transform:translate(-50%,-50%);
            background:rgba(0,0,0,0.7);
            padding:20px;
            border-radius:15px;
            font-size:22px;
            text-align:center;
            color:white;
        }
        .container, h1, .geri-btn { display:none; }
    }
</style>
</head>
<body>

<button class="geri-btn" onclick="window.location.href='index.html'">‚üµ Geri</button>

<h1>ARKADA≈ûLAR</h1>

<div class="container">
    <div class="card">
        <h3>ID ile Arkada≈ü Ekle</h3>
        <input type="text" id="friendId" placeholder="Arkada≈ü ID gir...">
        <button onclick="istekGonder()">ƒ∞stek G√∂nder</button>
    </div>

    <div class="card">
        <h3>Arkada≈ü ƒ∞stekleri</h3>
        <div id="istekListesi"></div>
    </div>

    <div class="card">
        <h3>Arkada≈ülarƒ±m</h3>
        <div id="arkadasListesi"></div>
    </div>
</div>

<!-- Online davet kutularƒ± -->
<div id="onlineInvites"></div>

<!-- Socket.io -->
<script src="/socket.io/socket.io.js"></script>

<script>
    let arkadaslar = JSON.parse(localStorage.getItem("arkadaslar")) || [];
    let istekler = JSON.parse(localStorage.getItem("istekler")) || [];

    function istekGonder() {
        const id = document.getElementById("friendId").value.trim();
        if(id === "") return alert("ID giriniz!");
        istekler.push({id:id});
        localStorage.setItem("istekler", JSON.stringify(istekler));
        document.getElementById("friendId").value = "";
        render();
        alert(id + " ID'li oyuncuya istek g√∂nderildi!");
        // Online davet g√∂nder
        if(socket) socket.emit("sendInvite", { toId: id, fromName: playerName });
    }

    function kabulEt(index) {
        const friend = istekler[index];
        arkadaslar.push(friend);
        istekler.splice(index,1);
        localStorage.setItem("arkadaslar", JSON.stringify(arkadaslar));
        localStorage.setItem("istekler", JSON.stringify(istekler));
        render();
    }

    function reddet(index) {
        istekler.splice(index,1);
        localStorage.setItem("istekler", JSON.stringify(istekler));
        render();
    }

    function davetEt(id) {
        alert(id + " ID'li oyuncu davet edildi! (Takƒ±m kurma burada √ßalƒ±≈üacak)");
    }

    function render() {
        const istekListesi = document.getElementById("istekListesi");
        const arkadasListesi = document.getElementById("arkadasListesi");
        istekListesi.innerHTML = "";
        arkadasListesi.innerHTML = "";

        istekler.forEach((istek,i)=>{
            const div = document.createElement("div");
            div.className = "istek";
            div.innerHTML = `
                <span><b>${istek.id}</b> sana arkada≈ülƒ±k isteƒüi g√∂nderdi.</span>
                <div class="istek-btns">
                    <button style="background:linear-gradient(180deg,#4caf50,#087f23)" onclick="kabulEt(${i})">Kabul</button>
                    <button style="background:linear-gradient(180deg,#f44336,#b71c1c)" onclick="reddet(${i})">Reddet</button>
                </div>
            `;
            istekListesi.appendChild(div);
        });

        arkadaslar.forEach(friend=>{
            const div = document.createElement("div");
            div.className = "friend";
            div.innerHTML = `
                <span>${friend.id}</span>
                <button style="background:linear-gradient(180deg,#2979ff,#0d47a1)" onclick="davetEt('${friend.id}')">Davet Et</button>
            `;
            arkadasListesi.appendChild(div);
        });
    }

    render();

    // ------------------- ONLINE EKLEMELER -------------------
    const socket = io();
    const playerName = localStorage.getItem("playerName") || prompt("Adƒ±nƒ±zƒ± girin:") || "Oyuncu";

    // Gelen davetler
    const onlineInvites = document.getElementById("onlineInvites");
    socket.on("receiveInvite", ({fromId, fromName}) => {
        const div = document.createElement("div");
        div.className = "inviteBox";
        div.innerHTML = `<span>${fromName} sana davet g√∂nderdi!</span>
        <div>
            <button onclick="acceptInvite('${fromId}','${fromName}',this)">Kabul</button>
            <button onclick="rejectInvite(this)">Reddet</button>
        </div>`;
        onlineInvites.appendChild(div);
    });

    function acceptInvite(fromId, fromName, btn) {
        alert(`${fromName} ile lobiye katƒ±ldƒ±nƒ±z!`);
        btn.parentElement.parentElement.remove();
        socket.emit("acceptInvite", { fromId, friendName: playerName });
    }

    function rejectInvite(btn) {
        btn.parentElement.parentElement.remove();
    }
</script>

</body>
</html>
